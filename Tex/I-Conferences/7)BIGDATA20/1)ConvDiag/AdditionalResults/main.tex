\documentclass{article}

\usepackage[margin=1in]{geometry}
\usepackage[colorlinks,linkcolor=blue,filecolor=blue,citecolor=magenta,urlcolor=blue]{hyperref}
\usepackage{bm,amsmath,amsthm,amssymb,multicol,algorithmic,algorithm,enumitem,graphicx,subfigure}
\usepackage{xargs}
\usepackage{stmaryrd}


\input{shortcuts}


\begin{document}



\title{Additional Results for Convergence Diagnostic with SGDM}

\date{}
\maketitle


\section{No Early Restarts with Pflug on SGDM}
\subsection{SGD for convex}
In \cite{pesme2020convergence}, the authors claim that Pflug's statistic fails to detect convergence of a simple SGD procedure for convex objective functions:
\begin{equation}\label{eq:sgd-vanilla}
\theta_{n+1} = \theta_{n} - \gamma \nabla \ell ( \theta_{n}, \xi_{n+1} )
\end{equation}
Also denote the noise term $\epsilon_n(\theta) = \nabla \ell ( \theta_{n}, \xi_{n+1} ) - \nabla \ell ( \theta_{n} )$ as the gap between the stochastic gradient and the full one.
On the simple example of a quadratic function and under the following assumption:
\begin{assumption}\label{ass:noise}
(Quadratic semi-stochastic setting). There exists a symmetric positive semi-definite matrix $H$ such that $\ell(\theta) = \frac{1}{2} \theta^\top H \theta $ and the noise $\epsilon_n(\theta) = \epsilon_n$ is independent of $\theta$ with:
\beq
\left(\epsilon_n\right)_{n \geq 0} \text { are i.i.d.}, \mathbb{E}\left[\epsilon_n \right]=0, \mathbb{E}\left[\epsilon_n^{T} \epsilon_n\right]=C .
\eeq
\end{assumption}
And also:
\begin{assumption}\label{ass:sym}
Noise symmetry and continuity:
$$\mathbb{P}\left(\epsilon_{1}^{T} \epsilon_{2} \geq x\right)=\mathbb{P}\left(\epsilon_{1}^{T} \epsilon_{2} \leq-x\right) \text { for all } x \geq 0$$
\end{assumption}
Then under H~\ref{ass:noise} and H~\ref{ass:sym}, they prove:
\begin{Prop}
Assume an initial point $\theta_0 \sim \pi_{old}$ sampled from the stationary distribution $\pi_{old}$ for a SGD trajectory ran with a constant stepsize $\gamma_{old}$ and run SGD with the new decayed stepsize $\gamma = r \times \gamma_{old}$. 
Then for any $0<\alpha<2$ and iteration number $n_{\gamma} = O(\gamma^{-\alpha})$ we have:
$$
\lim _{\gamma \rightarrow 0} \mathbb{P}_{\theta_{0} \sim \pi_{\gamma_{\text {old}}}}\left(S_{n_{\gamma}} \leq 0\right)=\frac{1}{2}
$$
where $S_{n_{\gamma}}$ is the Pflug statistic.
\end{Prop}
The signal during the transient phase is positive and if order $O(\gamma)$.
 However the variance of Sn is $O(1/n)$. Hence $\Omega(1/\gamma^2)$ iterations
are typically needed in order to have a clean signal.
Then, the main claim of this Proposition is that before this threshold, $S_n$ resembles a random walk and its sign gives no information on whether saturation is reached or
not, this leads to early on restart


\subsection{SGD with Momentum for convex}
\begin{equation}\label{eq:sgdm}
\theta_{n+1} = \theta_{n} - \gamma \nabla \ell ( \theta_{n}, \xi_{n+1} ) + \beta ( \theta_{n} - \theta_{n-1} )
\end{equation}
\newpage

\bibliographystyle{apalike}
\bibliography{ref}



%-----------------------------------------------------------------------------
%\vspace{0.4cm}

\end{document} 